<%# Matrice des positions relatives entre vaisseaux %>
<% if positions.any? %>
  <div class="mt-4">
    <h5 style="color: #17a2b8;">Positions relatives</h5>
    <div class="table-responsive">
      <table class="table table-dark table-sm">
        <thead>
          <tr>
            <th style="color: #17a2b8;">Vaisseau A</th>
            <th style="color: #17a2b8;">Position</th>
            <th style="color: #17a2b8;">Vaisseau B</th>
            <% if current_user&.group&.name == "MJ" %>
              <th style="color: #17a2b8;">Forcer</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% positions.each do |pos| %>
            <tr>
              <td>
                <span style="color: <%= pos.participant_a.side.zero? ? '#17a2b8' : '#dc3545' %>;">
                  <%= pos.participant_a.ship_name %>
                </span>
              </td>
              <td>
                <span class="badge bg-<%= position_badge_color(pos.position) %>">
                  <%= pos.position_label %>
                </span>
              </td>
              <td>
                <span style="color: <%= pos.participant_b.side.zero? ? '#17a2b8' : '#dc3545' %>;">
                  <%= pos.participant_b.ship_name %>
                </span>
              </td>
              <% if current_user&.group&.name == "MJ" %>
                <td>
                  <select class="form-select form-select-sm bg-dark text-white"
                          style="font-size: 0.75rem; width: auto;"
                          data-action="change->space-combat#overridePosition"
                          data-position-id="<%= pos.id %>">
                    <% ShipCombatPosition.positions.each do |key, _| %>
                      <option value="<%= key %>" <%= 'selected' if pos.position == key %>>
                        <%= ShipCombatPosition::POSITION_LABELS[key] %>
                      </option>
                    <% end %>
                  </select>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% end %>
