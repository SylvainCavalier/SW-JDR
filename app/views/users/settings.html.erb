<div class="frame-container" style="position: relative; width: 100%; height: 100vh; overflow-y: auto; overflow-x: hidden;">
  <!-- Username -->
  <p class="username-display mt-1 text-primary fw-bold">
    <%= current_user.username.titleize %>
  </p>
  
  <!-- Cadre central avec l'écran de réglages -->
  <div class="settings-container">
    <h1 class="text-center">Réglages</h1>

    <!-- ===== SECTION DONS/TALENTS ===== -->
    <% if ["Mercenaire", "Sénateur", "Autodidacte", "Bio-savant", "Contrebandier"].include?(current_user.classe_perso&.name) %>
      <div class="settings-section">
        <h3 class="settings-section-title">
          <i class="fa-solid fa-star"></i> Talents
        </h3>
        
        <%= form_with(model: current_user, url: update_settings_user_path(current_user), method: :patch, local: true, class: "settings-form") do |f| %>
          <% if ["Mercenaire", "Sénateur", "Autodidacte"].include?(current_user.classe_perso&.name) %>
            <div class="settings-checkbox">
              <%= f.check_box :robustesse, class: "form-check-input" %>
              <%= f.label :robustesse, "Robustesse", class: "form-check-label ms-2" %>
            </div>
          <% end %>
          
          <% if ["Bio-savant", "Autodidacte"].include?(current_user.classe_perso&.name) %>
            <div class="settings-checkbox">
              <%= f.check_box :homeopathie, class: "form-check-input" %>
              <%= f.label :homeopathie, "Homéopathie", class: "form-check-label ms-2" %>
            </div>
            <div class="settings-checkbox">
              <%= f.check_box :junkie, class: "form-check-input" %>
              <%= f.label :junkie, "Junkie", class: "form-check-label ms-2" %>
            </div>
          <% end %>
          
          <% if ["Contrebandier", "Autodidacte"].include?(current_user.classe_perso&.name) %>
            <div class="settings-checkbox">
              <%= f.check_box :luck, class: "form-check-input" %>
              <%= f.label :luck, "Chance du Contrebandier", class: "form-check-label ms-2" %>
            </div>
          <% end %>

          <%= f.submit "Enregistrer les talents", class: "btn btn-outline-success btn-sm mt-3" %>
        <% end %>
      </div>
    <% end %>

    <!-- ===== SECTION COMPTE ===== -->
    <div class="settings-section">
      <h3 class="settings-section-title">
        <i class="fa-solid fa-envelope"></i> Email de récupération
      </h3>
      <p class="settings-hint">
        Cet email sera utilisé pour récupérer votre mot de passe en cas d'oubli.
      </p>
      
      <%= form_with(model: current_user, url: update_account_user_path(current_user), method: :patch, local: true, class: "settings-form") do |f| %>
        <div class="settings-field">
          <%= f.label :email, "Adresse email", class: "form-label" %>
          <%= f.email_field :email, class: "form-control", placeholder: "votre@email.com" %>
        </div>
        
        <%= f.submit "Mettre à jour l'email", class: "btn btn-outline-success btn-sm mt-3" %>
      <% end %>
    </div>

    <!-- ===== SECTION MOT DE PASSE ===== -->
    <div class="settings-section">
      <h3 class="settings-section-title">
        <i class="fa-solid fa-key"></i> Changer le mot de passe
      </h3>
      
      <%= form_with(model: current_user, url: update_password_user_path(current_user), method: :patch, local: true, class: "settings-form") do |f| %>
        <div class="settings-field">
          <%= f.label :current_password, "Mot de passe actuel", class: "form-label" %>
          <%= f.password_field :current_password, class: "form-control", placeholder: "••••••••", autocomplete: "current-password" %>
        </div>
        
        <div class="settings-field">
          <%= f.label :password, "Nouveau mot de passe", class: "form-label" %>
          <%= f.password_field :password, class: "form-control", placeholder: "••••••••", autocomplete: "new-password" %>
          <small class="form-text text-muted">6 caractères minimum</small>
        </div>
        
        <div class="settings-field">
          <%= f.label :password_confirmation, "Confirmer le nouveau mot de passe", class: "form-label" %>
          <%= f.password_field :password_confirmation, class: "form-control", placeholder: "••••••••", autocomplete: "new-password" %>
        </div>
        
        <%= f.submit "Changer le mot de passe", class: "btn btn-outline-warning btn-sm mt-3" %>
      <% end %>
    </div>
  </div>

  <%= link_to "Retour", user_path(current_user), class: "btn btn-outline-secondary go-back" %>
</div>
