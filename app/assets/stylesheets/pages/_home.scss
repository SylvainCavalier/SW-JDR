// ===========================================
// PAGE HOME - Styles restructurés avec Flexbox
// ===========================================

// ----- RESET DES STYLES BOOTSTRAP DU PARENT -----
// Le layout application.html.erb utilise container-fluid avec des classes flexbox
// On doit les override pour que notre layout fonctionne

// Le parent #background a des classes Bootstrap qui interfèrent
#background {
  display: block !important;
  align-items: initial !important;
  justify-content: initial !important;
}

.frame-container {
  position: relative !important;
  width: 100vw !important;
  height: 100vh !important;
  overflow: hidden;
  // Reset des styles flexbox Bootstrap hérités
  display: block !important;
}

// ----- CADRE PRINCIPAL -----
.ui-frame {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: auto;
  min-height: 100%;
  object-fit: fill;
  z-index: -1;
}

// ----- CONTAINER PRINCIPAL DU CONTENU -----
.home-content {
  position: absolute !important;
  top: 12%;
  left: 10%;
  right: 10%;
  bottom: 15%;
  display: block !important;
  z-index: 2;
}

// ----- USERNAME EN HAUT -----
.username-display {
  position: absolute;
  top: 2%;
  left: 50%;
  transform: translateX(-50%);
  font-size: clamp(1rem, 2vw, 1.5rem);
  font-weight: bold;
  color: #00ffcc;
  z-index: 2;
  white-space: nowrap;
  margin: 0 !important; // Override Bootstrap mt-1
}

// ===========================================
// LIGNE DU HAUT
// ===========================================
.home-row-top {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: flex-start;
  min-height: 80px;
  // DEBUG
  // border: 1px dashed yellow;
}

// Bloc gauche : icônes de navigation (function, fight, holonews)
.home-top-icons {
  display: flex !important;
  flex-direction: row !important;
  align-items: center;
  gap: 0.5vw;
}

.ui-function {
  width: clamp(50px, 10vw, 120px);
  height: auto;
}

.fight-btn {
  display: flex;
  align-items: center;
}

.fight-icon {
  width: clamp(50px, 10vw, 130px);
  height: auto;
}

.holonews-btn {
  position: relative;
  display: flex;
  align-items: flex-start;
  
  // Le lien parent pour le badge Bootstrap
  a.position-relative {
    display: inline-block;
  }
}

.holonews-icon {
  width: clamp(45px, 8vw, 100px);
  height: auto;
}

// Le span holonews-count est juste un wrapper, le vrai badge est le span.badge à l'intérieur
.holonews-count {
  .badge {
    padding: 4px 6px !important;
    z-index: 5;
    top: 5%;
    left: 75%;
  }
}

// Bloc droite : barre SVG avec icônes d'objets actifs
.top-bar-container {
  position: relative;
  width: clamp(150px, 30vw, 350px);
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

.ui-top-bar {
  width: 100%;
  height: auto;
}

// Icônes sur la barre du haut
.patch-icon,
.injection-icon,
.implant-icon,
.sphero-icon {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: clamp(0.8em, 1.5vw, 1.3em);
  color: white;
  z-index: 3;
}

.patch-icon {
  left: 35%;
}

.injection-icon {
  left: 47%;
}

.implant-icon {
  left: 59%;
}

.sphero-icon {
  left: 71%;
}

// ===========================================
// LIGNE DU MILIEU (plus grande)
// ===========================================
.home-row-middle {
  position: absolute !important;
  top: 50% !important;
  left: 0 !important;
  right: 0 !important;
  transform: translateY(-50%);
  display: flex !important;
  justify-content: space-around !important;
  align-items: center;
  
  // Les liens ne doivent pas casser le layout
  > a {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  // DEBUG
  // border: 1px dashed cyan;
}

// Bloc gauche : Avatar
.avatar-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 15%;
}

.avatar-label {
  display: flex;
  justify-content: center;
  align-items: center;
  width: clamp(60px, 10vw, 100px);
  height: clamp(60px, 10vw, 100px);
  border-radius: 15px;
  border: 3px solid #00aaff;
  background-color: white;
  cursor: pointer;
  overflow: hidden;
  box-shadow: 0 0 10px #00aaff, 0 0 30px rgba(0, 170, 255, 0.5);
  transition: transform 0.2s ease-in-out, box-shadow 0.3s ease-in-out;
}

.avatar-label:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px #00aaff, 0 0 40px rgba(0, 170, 255, 0.7);
}

.avatar-preview,
.avatar-placeholder {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 50px;
  font-weight: bold;
  color: #00aaff;
}

// Bloc centre : Container crédits/XP avec screen SVG
.credits-container {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: clamp(200px, 35vw, 500px);
  margin: 0 !important; // Override Bootstrap mt-1
}

.screen-background {
  width: 100%;
  height: auto;
  max-width: 500px;
}

.credits-text {
  position: absolute;
  top: 30%;
  left: 55%;
  transform: translateX(-50%);
  z-index: 2;
  font-size: 1em;
  color: $success;
  width: 80%;
}

.xp-container {
  position: absolute;
  top: 55%;
  left: 50%;
  transform: translateX(-50%);
  z-index: 2;
  font-size: 1em;
}

.xp-text {
  margin: 0;
}

// Bloc droite : Boucliers
.shields-container {
  display: flex !important;
  flex-direction: row !important;
  align-items: center;
  justify-content: center;
  gap: 2vw;
  width: 20%;
}

.shield,
.echani-shield {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center;
  text-align: center;
  
  // Les turbo-frames doivent s'afficher en colonne aussi
  turbo-frame {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
  }
}

.shield-icon,
.echani-shield-icon {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  cursor: pointer;
}

.shield-icon i,
.echani-shield-icon i {
  font-size: clamp(1.5rem, 4vw, 3rem);
  transition: all 0.3s ease;
}

.shield-icon i {
  color: #00008B;
}

.echani-shield-icon i {
  color: #815f03;
}

.fa-shield.active {
  color: #00BFFF !important;
  text-shadow: 0px 0px 15px #00BFFF !important;
}

.echani-shield .fa-shield.active {
  color: #d9aa01 !important;
  text-shadow: 0px 0px 15px #d9aa01 !important;
}

.shield p,
.echani-shield p {
  font-size: clamp(0.5em, 1vw, 0.8em);
  text-align: center;
  margin: 5px 0 !important;
  white-space: nowrap;
}

.shield .btn,
.echani-shield .btn {
  font-size: clamp(0.6em, 1vw, 0.8em);
  padding: 2px 8px;
  margin-top: 5px;
  width: auto;
  align-self: center;
}

// ===========================================
// LIGNE DU BAS
// ===========================================
.home-row-bottom {
  display: flex !important;
  justify-content: space-around !important;
  align-items: flex-end !important;
  width: 100%;
  min-height: 100px;
  // Position absolue en bas du conteneur parent
  position: absolute !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
}

// Bloc gauche : Barre de PV et statut
.hp-status-container {
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-start;
  justify-content: flex-end;
  width: 50%;
  
  // Turbo-frames inline pour ne pas casser le layout
  turbo-frame {
    display: block;
    width: 100%;
  }
}

.status-container {
  margin: 0 0 5px 0 !important;
}

.status-container p {
  margin: 0 !important;
  font-size: clamp(0.7em, 1.2vw, 1em);
}

// Surcharges spécifiques à la page home pour la barre HP
.hp-status-container .hp-bar-container {
  max-width: 350px;
  min-height: 35px;
  aspect-ratio: 1001.46 / 140.26;
}

// Bloc centre : Dé
.dice-container-home {
  display: flex !important;
  justify-content: center !important;
  align-items: flex-end !important;
  width: 20%;
}

.dice-home {
  width: clamp(50px, 10vw, 120px);
  height: auto;
  transition: transform 0.2s ease;
}

.dice-home:hover {
  transform: scale(1.1);
}

// Bloc droite : Boutons de navigation
.home-bottom-buttons {
  display: flex !important;
  flex-direction: column !important;
  align-items: flex-end !important;
  gap: 5px;
}

.home-bottom-buttons .d-flex {
  display: flex !important;
  gap: 5px;
}

.team-home {
  font-size: clamp(0.9em, 1.2vw, 1em) !important;
  padding: clamp(4px, 0.8vw, 8px) clamp(6px, 1vw, 12px) !important;
}

// ===========================================
// FOOTER : Race et Classe
// ===========================================
.race,
.classe {
  position: absolute;
  bottom: 3%;
  z-index: 2;
}

.race {
  left: 20%;
}

.classe {
  right: 20%;
}

.race p,
.classe p {
  margin: 0;
  font-size: clamp(0.7em, 1.2vw, 1em);
}

// ===========================================
// ANIMATIONS ET NOTIFICATIONS
// ===========================================
.xp-notification {
  background-color: #4caf50;
  color: white;
  padding: 10px;
  margin-top: 10px;
  border-radius: 5px;
  animation: fadeOut 3s ease forwards;
}

@keyframes fadeOut {
  0% { opacity: 1; }
  100% { opacity: 0; }
}

// ===========================================
// RESPONSIVE ADJUSTMENTS
// ===========================================
@media screen and (min-width: 1024px) {
  .home-content {
    top: 15%;
    left: 12%;
    right: 12%;
    bottom: 15%;
  }

  .home-row-middle {
    padding: 3vh 0;
  }

  .shields-container {
    gap: 3vw;
  }
  
  .hp-status-container .hp-bar-container {
    min-height: 50px;
  }
}

// Pour les très grands écrans
@media screen and (min-width: 1400px) {
  .credits-container {
    width: clamp(250px, 30vw, 450px);
  }

  .avatar-label {
    width: clamp(80px, 8vw, 110px);
    height: clamp(80px, 8vw, 110px);
  }
}

// ===========================================
// BOUTON DE DÉCONNEXION
// ===========================================
.logout-btn {
  position: absolute;
  top: 10px;
  right: 70px;
  color: #333;
  font-size: 10px;
  text-decoration: none;
  z-index: 3;
  background: transparent;
  border: none;
  cursor: pointer;
}
